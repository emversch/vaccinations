<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="noindex">
  <title>Generate image</title>
  <style>
    canvas{
      -moz-user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
    .card-header {
      font-size: 1.5em;
    }
    .card-text {
      font-size: 1.3em;
    }
	</style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css" integrity="sha512-/zs32ZEJh+/EO2N1b0PEdoA10JkdC3zJ8L5FTiQu82LR9S/rOQNfQN7U59U9BC12swNeRAz3HSzIL2vpp4fv3w==" crossorigin="anonymous" />
</head>
<body>
  <h1>Image</h1>
  <div class="mb-5" id="target" style="border: 1px solid black"></div>

  <h1>Source</h1>
  <main class="container" id="source" style="width: 1000px;background-color: white">
    <div class="row">
      <div class="col-12">
        <h2 class="text-center">Percentage van gevaccineerde Lommelaars op {{ $.Site.Data.numbers.last_date }} üíö</h2>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6 d-flex">
        <div class="card text-white bg-success mb-2 flex-fill">
          <div class="card-header">Volledig gevaccineerd üöÄ</div>
          <div class="card-body">
            <div class="row">
              <div class="col-4">
                <h2 class="card-title">{{ range last 1 $.Site.Data.numbers.total.timeseries_second_dose }}{{ . }}{{ end }}%</h2>
              </div>
              <div class="col-8">
                <p class="card-text ml-3">Dat zijn <strong>{{ $.Site.Data.numbers.second_dose }}</strong> van de
                  <strong>{{ lang.NumFmt 0 $.Site.Data.numbers.population "- , ." }}</strong> Lommelaars.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6 d-flex">
        <div class="card text-white bg-primary mb-2 flex-fill">
          <div class="card-header">Minstens 1 dosis gehad ü§ó</div>
          <div class="card-body">
            <div class="row">
              <div class="col-4">
                <h2 class="card-title">{{ range last 1 $.Site.Data.numbers.total.timeseries_minimum_one_dose }}{{ . }}{{ end }}%</h2>
              </div>
              <div class="col-8">
                <p class="card-text">Dat zijn <strong>{{ $.Site.Data.numbers.minimum_one_dose }}</strong> van de
                <strong>{{ lang.NumFmt 0 $.Site.Data.numbers.population "- , ." }}</strong> Lommelaars.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 mb-3 h-100">
        <canvas id="canvas"></canvas>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <p class="text-center" style="font-size: 1.3em">Volg de dagelijkse updates via <strong>lommel.lukin.be</strong></p>
      </div>
    </div>
  </main>

<!--          <div class="col-md-12 d-flex">-->
<!--            <div class="card mb-3 flex-fill">-->
<!--            <div class="card-body">-->
<!--              <h6 class="card-title">Bron van de cijfers üîç</h6>-->
<!--              <small class="text-muted"><a href="https://www.laatjevaccineren.be/vaccinnet" target="_blank">Vaccinnet+</a>-->
<!--                is het vaccinatie platform van de Vlaamse Overheid. Cijfers worden dagelijks ge√Ømporteerd, behalve op weekenddagen.</small><br><br>-->
<!--              <small class="text-muted">Laatste update: 25.02.2021</small>-->
<!--            </div>-->
<!--          </div>-->
<!--          </div>-->


  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js" integrity="sha512-SuxO9djzjML6b9w9/I07IWnLnQhgyYVSpHZx0JV97kGBfTIsUYlWflyuW4ypnvhBrslz1yJ3R+S14fdCWmSmSA==" crossorigin="anonymous"></script>
  <script>
    var TOTAL_LABELS = {{ $.Site.Data.numbers.total.labels }};
    var TOTAL_ONE_DOSE = {{ $.Site.Data.numbers.total.timeseries_minimum_one_dose }};
    var TOTAL_SECOND_DOSE = {{ $.Site.Data.numbers.total.timeseries_second_dose }};
  </script>
  <script>
    var colorBlue = '#0d6efd';
    var colorGreen = '#198754';

		var config = {
			type: 'line',
			data: {
				labels: TOTAL_LABELS,
        datasets: [{
					label: 'Volledig gevaccineerd',
          fill: false,
          pointRadius: 0,
          lineTension: 0,
          datalabels: {color: colorGreen},
					backgroundColor: colorGreen,
					borderColor: colorGreen,
          data: TOTAL_SECOND_DOSE
				}, {
					label: 'Minstens 1 dosis gehad',
					fill: false,
          pointRadius: 0,
          lineTension: 0,
          datalabels: {color: colorBlue},
					backgroundColor: colorBlue,
					borderColor: colorBlue,
          data: TOTAL_ONE_DOSE
				}]
			},
			options: {
				responsive: true,
        maintainAspectRatio: true,
				title: {
					display: false
        },
				tooltips: {
					mode: 'index',
					intersect: false
				},
				hover: {
					mode: 'nearest',
					intersect: false,
				},
				scales: {
					xAxes: [{
						display: true,
            ticks: {
              fontSize: 17
            },
						scaleLabel: {
							display: true,
              labelString: 'Dagen',
              fontSize: 14
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: true,
              labelString: 'Percentage',
              fontSize: 14
						},
            ticks: {
              fontSize: 17,
              callback: function(v, i, vv) {
                  return v.toFixed(2).toString().replace(".", ".") + "%";
              }
            }
					}]
				},
			}
		};

		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myLine = new Chart(ctx, config);
		};
	</script>

<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js" integrity="sha512-s/XK4vYVXTGeUSv4bRPOuxSDmDlTedEpMEcAQk0t/FMd9V6ft8iXdwSBxV0eD60c6w/tjotSlKu9J2AAW1ckTA==" crossorigin="anonymous"></script>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js" integrity="sha512-OqcrADJLG261FZjar4Z6c4CfLqd861A3yPNMb+vRQ2JwzFT49WT4lozrh3bcKxHxtDTgNiqgYbEUStzvZQRfgQ==" crossorigin="anonymous"></script>
  <script>
      setTimeout(function(){
        html2canvas(document.getElementById("source"), {
          onrendered: function(canvas) {
              var image = document.createElement("img");
              image.src = canvas.toDataURL("image/png");
              document.getElementById("target").appendChild(image);
          }
        })
      }, 500)

  </script>
</body>
</html>
