<!DOCTYPE html>
<!-- Define Data from the Hugo data folder. Eg: `numbers_lommel` -->
{{ $data := (index $.Site.Data .Params.Data )}}
{{ $municipality := .Params.Municipality }}
{{ $inhabitants := .Params.Inhabitants }}
{{ $title := printf "Covid Vaccinaties %s" .Params.Municipality }}
{{ $description := printf "Dagelijkse update over de vaccinatie cijfers in %s." .Params.Municipality }}

<html lang="nl"
      xmlns:og="http://opengraphprotocol.org/schema/"
      xmlns:fb="http://www.facebook.com/2008/fbml"
      xmlns="http://www.w3.org/1999/html">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="{{ $description }}">
  <meta name="author" content="{{ .Site.Author.name }}">
  <link rel="icon" type="image/svg+xml" href="/img/syringe.svg">
  <link rel="icon" type="image/png" href="/img/syringe.png">
  <meta name="theme-color" content="#198754">
  <meta name="robots" content="index, follow">
  <title>{{ $title }}</title>
  <meta property="og:title" content="{{ $title }}">
  <meta property="og:locale" content="nl_BE">
  <meta property="og:url" content="https://vaccinaties.lukin.be/{{ lower $municipality }}/">
  <meta property="og:sitename" content="{{ $title }}">
  <meta property="og:type" content="website">
  <meta property="og:description" content="{{ $description }}">
  <meta property="og:image" content="https://vaccinaties.lukin.be/img/soeverein.png">
  <meta property="og:image:url" content="https://vaccinaties.lukin.be/img/soeverein.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:description" content="{{ $description }}">
  <meta name="twitter:image" content="https://vaccinaties.lukin.be/img/soeverein.png">
  <style>
    canvas{
      -moz-user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
    body {
        background-image: linear-gradient(150deg,#ffffff 30%,#F8F8F8 95%);
        /*background-image: linear-gradient(150deg,#ffffff 30%,red 95%);*/
    }
    .graph {
        background-color: #f8f8f8;
        border-radius: .25rem;
        border: 1px solid rgba(0,0,0,.05);
        background-image: linear-gradient(150deg,#ffffff 0%,#F8F8F8 95%);
        /*background-image: linear-gradient(150deg,#F8F8F8 0%,#ffffff 95%);*/
        /*background-image: linear-gradient(150deg,transparent 70%,red 95%);*/
        /*box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);*/
    }
    @media only screen and (min-width: 1200px) {
      #main {
        max-width: 80%;
      }
    }
	</style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css" integrity="sha512-/zs32ZEJh+/EO2N1b0PEdoA10JkdC3zJ8L5FTiQu82LR9S/rOQNfQN7U59U9BC12swNeRAz3HSzIL2vpp4fv3w==" crossorigin="anonymous" />
  {{ template "_internal/google_analytics.html" . }}
</head>
<body>
  <main class="container" id="main">
    <div class="px-3 py-3 py-md-5 mb-4 mx-auto text-center">
      <h1 class="display-4">Covid Vaccinaties in {{ $municipality }} 💉</h1>
      <p class="lead mb-0">Dagelijkse update over de vaccinatie cijfers van inwoners van {{ $municipality }}. 💚 </p>
      <small class="text-muted">Laatste update: {{ $data.last_date }}
        <strong>//</strong> Dagelijks update in de voormiddag
        <strong>//</strong> Bron: <a href="https://www.laatjevaccineren.be/vaccinnet" target="_blank">Vaccinnet+</a>
      </small>
    </div>

    <div class="row py-3 py-md-5 border-top">
      <div class="md-12">
        <ul class="nav nav-pills nav-fill" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#history-all" role="tab">Alle leeftijden</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#history-adults" role="tab">Enkel volwassenen (18+)</a>
          </li>
        </ul>
      </div>
    </div>

    <div class="tab-content mb-3 mb-md-5">
      <div class="tab-pane show active" id="history-all" role="tabpanel">
        <div class="row">
          <div class="col-md-12 col-lg-9 pb-3 h-100">
            <h5 class="text-center">Percentage van gevaccineerde {{ $inhabitants }} (alle leeftijden)</h5>
            <canvas id="canvasHistoryAll"></canvas>
          </div>
          <div class="col-md-12 col-lg-3">
            <div class="row">
              <div class="col-md-6 col-lg-12 col-sm-12 d-flex">
                <div class="card text-white border-0 bg-success mb-3 flex-fill">
                  <div class="card-header">Volledig gevaccineerd 🚀</div>
                  <div class="card-body">
                    <h3 class="card-title">{{ range last 1 $data.history_all.timeseries_second_dose }}{{ lang.NumFmt 2 . }}{{ end }}%</h3>
                    <p class="card-text">Dat zijn <strong>{{ $data.history_all.second_dose }}</strong> van de
                      <strong>{{ lang.NumFmt 0 $data.history_all.population "- , ." }}</strong> {{ $inhabitants }}.</p>
                  </div>
                </div>
              </div>

              <div class="col-md-6 col-lg-12 d-flex">
                <div class="card text-white border-0 bg-primary flex-fill">
                  <div class="card-header">Minstens 1 dosis gehad 🤗</div>
                  <div class="card-body">
                    <h3 class="card-title">{{ range last 1 $data.history_all.timeseries_minimum_one_dose }}{{ lang.NumFmt 2 . }}{{ end }}%</h3>
                    <p class="card-text">Dat zijn <strong>{{ $data.history_all.minimum_one_dose }}</strong> van de
                      <strong>{{ lang.NumFmt 0 $data.history_all.population "- , ." }}</strong> {{ $inhabitants }}.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane" id="history-adults" role="tabpanel">
        <div class="row">
          <div class="col-md-12 col-lg-9 pb-3 h-100">
            <h5 class="text-center">Percentage van gevaccineerde {{ $inhabitants }} (enkel volwassenen)</h5>
            <canvas id="canvasHistoryAdults"></canvas>
          </div>
          <div class="col-md-12 col-lg-3">
            <div class="row">
              <div class="col-md-6 col-lg-12 col-sm-12 d-flex">
                <div class="card text-white border-0 bg-success mb-3 flex-fill">
                  <div class="card-header">Volledig gevaccineerd 🚀</div>
                  <div class="card-body">
                    <h3 class="card-title">{{ range last 1 $data.history_adults.timeseries_second_dose }}{{ lang.NumFmt 2 . }}{{ end }}%</h3>
                    <p class="card-text">Dat zijn <strong>{{ $data.history_adults.second_dose }}</strong> van de
                      <strong>{{ lang.NumFmt 0 $data.history_adults.population "- , ." }}</strong> volwassen {{ $inhabitants }}.</p>
                  </div>
                </div>
              </div>

              <div class="col-md-6 col-lg-12 d-flex">
                <div class="card text-white border-0 bg-primary mb-3 flex-fill">
                  <div class="card-header">Minstens 1 dosis gehad 🤗</div>
                  <div class="card-body">
                    <h3 class="card-title">{{ range last 1 $data.history_adults.timeseries_minimum_one_dose }}{{ lang.NumFmt 2 . }}{{ end }}%</h3>
                    <p class="card-text">Dat zijn <strong>{{ $data.history_adults.minimum_one_dose }}</strong> van de
                      <strong>{{ lang.NumFmt 0 $data.history_adults.population "- , ." }}</strong> volwassen {{ $inhabitants }}.</p>
                  </div>
                </div>
              </div>

              <div class="col-12 d-flex">
                <div class="card mb-2 p-2 flex-fill">
                  <div class="card-body">
                    <div class="card-text">De focus van de vaccinatiestrategie ligt momenteel op volwassenen (18+).</div>
                  </div>
                  <!--
                  <blockquote class="blockquote mb-0">
                    <p title="De Standaard"><a href="https://www.standaard.be/cnt/dmf20210112_97389052" target="_blank" class="text-dark">"Er zijn op dit moment onvoldoende wetenschappelijke argumenten om mensen onder de 18 jaar te vaccineren"</a></p>
                    <footer class="blockquote-footer">
                      <small>
                        Jan De Maeseneer <cite title="De Standaard">professor emeritus huisartsengeneeskunde (UGent)</cite>
                      </small>
                    </footer>
                  </blockquote>
                  -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row py-3 py-md-5 my-md-5 border-top">
      <div class="col-md-12 col-lg-8 mt-md-5 pb-3 h-100">
        <h5 class="text-center">Percentage van gevaccineerde {{ $inhabitants }} per leeftijdscategorie</h5>
        <canvas id="canvasPerAge"></canvas>
      </div>
      <div class="col-md-12 col-lg-4 mt-md-5">
        <div class="row">
          <!--
          <div class="col-md-12 col-lg-12 col-sm-12 d-flex">
            <div class="card mb-2 flex-fill">
              <div class="card-body">
                <p class="card-text">Percentage van gevaccineerde mensen binnen iedere leeftijdscategorie.</p>
              </div>
            </div>
          </div>
          -->
          <!--
          <div class="col-md-12 col-lg-12 col-sm-12 d-flex">
            <div class="card text-white bg-warning mb-3">
              <div class="card-body">
                <h5 class="card-title">Opmerking (Beta)</h5>
                <p class="card-text">Ik heb dit gisteren avond laat geprogrammeerd. De berekeningen van deze cijfers
                  moeten nog grondig nagekeken worden.</p>
              </div>
            </div>
          </div>
          -->

          <div class="col-md-6 col-lg-12 col-sm-12 d-flex">
            <div class="card text-white border-0 bg-success mb-3 flex-fill">
              <div class="card-header">Volledig gevaccineerde 80-plussers 🚀</div>
              <div class="card-body">
                <h3 class="card-title">{{ index $data.per_age.percentage_second_dose 0 }}%</h3>
                <p class="card-text">Dat zijn <strong>{{ index $data.per_age.second_dose 0 }}</strong> van de
                  <strong>{{ lang.NumFmt 0 (index $data.per_age.population 0) "- , ." }}</strong> mensen ouder dan 80 jaar.</p>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-12 d-flex">
            <div class="card text-white border-0 bg-primary mb-3 flex-fill">
              <div class="card-header">80-plussers met enkel 1 dosis 🤗</div>
              <div class="card-body">
                <h3 class="card-title">{{ index $data.per_age.percentage_first_dose 0 }}%</h3>
                <p class="card-text">Dat zijn <strong>{{ index $data.per_age.first_dose 0 }}</strong> van de
                  <strong>{{ lang.NumFmt 0 (index $data.per_age.population 0) "- , ." }}</strong> mensen ouder dan 80 jaar die nog maar 1 dosis hebben gehad.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row py-5 border-top" style="opacity: 0.7">
      <div class="row">
        <div class="col-12 text-center">
          <h6>Bron van de cijfers 🔍</h6>
          <small class="text-muted"><a href="https://www.laatjevaccineren.be/vaccinnet" target="_blank">Vaccinnet+</a> is
            het vaccinatie platform van de Vlaamse Overheid. Cijfers worden dagelijks geïmporteerd, behalve op weekenddagen.</small><br>
          <small class="text-muted">Laatste update: {{ $data.last_date }}</small>
        </div>
      </div>
    </div>

    <footer class="pt-4 pt-md-4 border-top" style="opacity: 0.7">
      <div class="row">
        <!-- col-md-12 col-lg-3 -->
        <div class="col-md-12 col-lg-6 col-md mb-3">
          <small class="text-muted">Deze pagina focust enkel op de vaccinatie cijfers van <strong>{{ $municipality }}</strong>.<br>
          De cijfers van België kan je volgen via <a href="https://covid-vaccinatie.be/nl" target="_blank">covid-vaccinatie.be</a>
          van <a href="https://twitter.com/jorisvaesen" target="_blank">@jorisvaesen</a></small>
        </div>
        <div class="col-md-12 col-lg-6 col-md mb-3">
          <small class="d-block mb-3 text-muted">
            👨‍💻 Pagina onderhouden door <a href="https://lukin.be" target="_blank">{{ .Site.Author.name }}</a><br>
            💡 Feedback of vragen: <a href="mailto:{{ .Site.Author.email }}?subject=Vaccinatie cijfers {{ $municipality }}">{{ .Site.Author.email }}</a><br>
            ⚡ ️Bekijk de code op <a href="https://github.com/lukin0110/vaccinations-lommel" target="_blank">GitHub</a>
          </small>
        </div>
      </div>
    </footer>
  </main>

  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <!-- Chart js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js" integrity="sha512-SuxO9djzjML6b9w9/I07IWnLnQhgyYVSpHZx0JV97kGBfTIsUYlWflyuW4ypnvhBrslz1yJ3R+S14fdCWmSmSA==" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>

  <script>
    // Data for the datasets
    var HISTORY_ALL_LABELS = {{ $data.history_all.labels }};
    var HISTORY_ALL_ONE_DOSE = {{ $data.history_all.timeseries_minimum_one_dose }};
    var HISTORY_ALL_SECOND_DOSE = {{ $data.history_all.timeseries_second_dose }};
    var HISTORY_ADULTS_LABELS = {{ $data.history_adults.labels }};
    var HISTORY_ADULTS_ONE_DOSE = {{ $data.history_adults.timeseries_minimum_one_dose }};
    var HISTORY_ADULTS_SECOND_DOSE = {{ $data.history_adults.timeseries_second_dose }};
    var PER_AGE_LABELS = {{ $data.per_age.labels }};
    var PER_AGE_FIRST_DOSE = {{ $data.per_age.percentage_first_dose }};
    var PER_AGE_SECOND_DOSE = {{ $data.per_age.percentage_second_dose }};
  </script>

  <script>
    Chart.plugins.unregister(ChartDataLabels);

    var colorBlue = '#0d6efd';
    var colorGreen = '#198754';

    Chart.Tooltip.positioners.custom = function(elements, eventPosition) {
      return {
        x: eventPosition.x,
        y: eventPosition.y
      };
    };

    function dataHistory(labels, second, one) {
      return {
        data: {
          labels: labels,
          datasets: [{
            label: 'Volledig gevaccineerd',
            fill: false,
            pointRadius: 0,
            pointHoverRadius: 6,
            lineTension: 0.07,
            datalabels: {color: colorGreen},
            backgroundColor: colorGreen,
            borderColor: colorGreen,
            data: second
          }, {
            label: 'Minstens 1 dosis gehad',
            fill: false,
            pointRadius: 0,
            pointHoverRadius: 6,
            lineTension: 0.07,
            datalabels: {color: colorBlue},
            backgroundColor: colorBlue,
            borderColor: colorBlue,
            data: one
          }]
        }
      };
    }

		var configHistory = {
      plugins: [ChartDataLabels],
			type: 'line',
			options: {
        plugins: {
          datalabels: {
            align: 'right',
              formatter: function (value, context) {
                  return value.toString().replace(".", ",") + "%";
              },
              display: function (context) {
                return context.dataIndex === context.dataset.data.length - 1;
              }
            }
        },
				responsive: true,
        maintainAspectRatio: true,
        layout:{
          padding: {
            right:50
          }
        },
				title: {
					display: false
        },
				tooltips: {
					mode: 'index',
					intersect: false
				},
				hover: {
					mode: 'nearest',
					intersect: false,
				},
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: true,
              labelString: 'Dagen'
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: false,
              labelString: 'Percentage'
						},
            ticks: {
              suggestedMax: 7,
              callback: function(value, index, values) {
                  return value.toFixed(2).toString().replace(".", ".") + "%";
              }
            }
					}]
				},
			}
		};

		var configPerAge = {
      type: 'horizontalBar',
      data: {
			labels: PER_AGE_LABELS,
			datasets: [{
        label: 'Volledig gevaccineerd',
        backgroundColor: colorGreen,
        data: PER_AGE_SECOND_DOSE
      }, {
        label: 'Enkel 1 dosis gehad',
        backgroundColor: colorBlue,
        data: PER_AGE_FIRST_DOSE
        }]
      },
      options: {
					title: {
						display: false
					},
					tooltips: {
            mode: 'index',
            intersect: true,
              position: 'custom',
              callbacks: {
                footer: function(tooltipItems, data) {
                  let total = 0;
                  for (let i = 0; i < tooltipItems.length; i++) {
                      total += tooltipItems[i].xLabel;
                  }
                  return 'Totaal: ' + total.toFixed(2) + '%';
                }
              }
					},
					responsive: true,
					scales: {
						xAxes: [{
							stacked: true,
              display: true,
              ticks: { max: 100 },
              scaleLabel: {
                display: false,
                labelString: 'Percentage'
              }
						}],
						yAxes: [{
							stacked: true,
              display: true,
              scaleLabel: {
                display: false,
                labelString: 'Leeftijd'
              }
						}]
					}
				}
    }

		window.onload = function() {
			var ctxHistoryAll = document.getElementById('canvasHistoryAll').getContext('2d');
			new Chart(ctxHistoryAll, Object.assign({}, configHistory, dataHistory(HISTORY_ALL_LABELS, HISTORY_ALL_SECOND_DOSE, HISTORY_ALL_ONE_DOSE)));
			var ctxHistoryAdults = document.getElementById('canvasHistoryAdults').getContext('2d');
			new Chart(ctxHistoryAdults, Object.assign({}, configHistory, dataHistory(HISTORY_ADULTS_LABELS, HISTORY_ADULTS_SECOND_DOSE, HISTORY_ADULTS_ONE_DOSE)));
			var ctxPerAge = document.getElementById('canvasPerAge').getContext('2d');
			new Chart(ctxPerAge, configPerAge);
		};
	</script>
</body>
</html>

